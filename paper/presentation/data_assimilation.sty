%
% Custom definitions for Data Assimilation latex documents
%
% Author:   Remi Barillec, 
%           Neural Computing Research Group, 
%           Aston University
%
% Revision history:
%   2007/12/02  Creation from different personal style files
%
%
\NeedsTeXFormat{LaTeX2e}[1999/06/01]
\ProvidesPackage{data_assimilation}[2007/12/02 Data assimilation notations]

\usepackage{xspace}
\usepackage{amsfonts}

\newcommand{\mathstyle}[1]{\ensuremath{\mathrm{#1}}}

\newcommand{\half}{\frac{1}{2}}
\newcommand{\trace}{\mathstyle{Tr}}

\renewcommand{\[}{\begin{equation}}
\renewcommand{\]}{\end{equation}}

% Vectors (bold face)
\newcommand{\mathsp}[1] {\ensuremath{#1}\xspace}
\newcommand{\vbold} [1] {\mathsp{\mathbf{#1}}}
\newcommand{\vnorm}[1]{\parallel #1 \parallel}    % Norm

% Real number space - possibly exponentiated
\newcommand{\realspace}[1][]{\ensuremath{\mathbb{R}^{#1}}}
% Transpose
\newcommand{\T}{\mathstyle{T}}


% Identity matrix
\newcommand{\Id}  {\vbold{I}}
\newcommand{\vK}  {\vbold{K}}

% Indexes
\renewcommand{\time}{\mathstyle{t}}
\newcommand{\timem}{{\time-1}}

% State and observations
\newcommand{\state}     {\vbold{x}}                          % state vector
\newcommand{\State}     {\vbold{X}}                          % state vector
\newcommand{\obscomp}   {\mathsp{y}}
\newcommand{\Obscomp}   {\mathsp{Y}}                                  % observation component
\newcommand{\obs}       {\vbold{\obscomp}}                            % observation vector
\newcommand{\Obs}       {\vbold{\Obscomp}}                            % observation vector
\newcommand{\obsj}      {\ensuremath{\obscomp_j}}                     % observation at pixel j
\newcommand{\obscov}    {\vbold{R}}                                   % observation noise covariance
\newcommand{\obsop}     {\mathsp{h}}
\newcommand{\linobsop}  {\mathsp{\vbold{H}}}
\newcommand{\obsspace}  {\ensuremath{\boldsymbol{\Omega}}}
\newcommand{\obserr}    {\mathsp{\boldsymbol{\epsilon}}\xspace}
\newcommand{\loc}       {\ensuremath{\vbold{s}}}                      % location (spatial)
\newcommand{\coordh}{h}
\newcommand{\coordv}{v}
\newcommand{\loch}       {\ensuremath{\loc^\coordh}}
\newcommand{\locv}       {\ensuremath{\loc^\coordv}}
                      % location
\newcommand{\locspace}  {\obsspace}               % location space
\newcommand{\modop}     {\mathsp{f}}
\newcommand{\sysop}     {\mathsp{m}}
\newcommand{\linsysop}  {\mathsp{\vbold{M}}}
\newcommand{\tanlinsysop}  {\mathsp{\vbold{\hat{M}}}}
\newcommand{\tanlinobsop}  {\mathsp{\vbold{\hat{H}}}}
\newcommand{\syserr}    {\mathsp{\boldsymbol{\eta}}}
\newcommand{\syscov}    {\vbold{Q}}                                   % system noise covariance



% Indexed
\renewcommand{\index}[2]{\mathsp{{#1}_{#2}}}
\newcommand{\statet}    {\index{\state}{\time}}    % state vector
\newcommand{\statetm}   {\index{\state}{\time-1}}  % state vector
\newcommand{\obst}      {\index{\obs}{\time}}      % observation vector
\newcommand{\Obst}      {\index{\Obs}{\time}}      % observation vector
\newcommand{\obstm}     {\index{\obs}{\time-1}}    % observation vector
\newcommand{\Obstm}     {\index{\Obs}{\time-1}}    % observation vector
\newcommand{\obsopt}    {\index{\obsop}{\time}}
\newcommand{\obscovt}   {\index{\obscov}{\time}}
\newcommand{\syscovt}   {\index{\syscov}{\time}}
\newcommand{\modopt}    {\index{\modopt}{\time}}
\newcommand{\sysopt}    {\index{\sysop}{\time}}
\newcommand{\sysoptm}    {\index{\sysop}{\time-1}}
\newcommand{\linsysopt}    {\index{\linsysop}{\time}}
\newcommand{\linobsopt}    {\index{\linobsop}{\time}}
\newcommand{\syserrt}   {\index{\syserr}{\time}}
\newcommand{\syserrtm}   {\index{\syserr}{\time-1}}
\newcommand{\obserrt}   {\index{\obserr}{\time}}
\newcommand{\Statet}    {\index{\State}{\time}}                          % state vector
\newcommand{\Statetm}    {\index{\State}{\time-1}}                          % state vector

\newcommand{\statemean} {\mathsp{\bar{\state}}}
\newcommand{\statecov}  {\mathsp{\vbold{P}}}
\newcommand{\statea}    {\mathsp{\state^{a}}}
\newcommand{\stateb}    {\mathsp{\state^{b}}}
\newcommand{\statef}    {\mathsp{\state^{f}}}
\newcommand{\stateamean}{\mathsp{\statemean^{a}}}
\newcommand{\statefmean}{\mathsp{\statemean^{f}}}
\newcommand{\statebmean}{\mathsp{\statemean^{b}}}
\newcommand{\stateacov} {\mathsp{\statecov^{a}}}
\newcommand{\statebcov} {\mathsp{\vbold{B}}}
\newcommand{\statefcov} {\mathsp{\statecov^{f}}}


% Probabilities
\newcommand{\pdf}          {probability density function\xspace}
\newcommand{\p}            {\xspace\mathstyle{p}\xspace}
\newcommand{\q}            {\xspace\mathstyle{q}\xspace}
\newcommand{\probx}     [1]{\xspace\mathsp{\p(#1)}}
\newcommand{\pxgy}      [2]{\xspace\mathsp{\p(#1|#2)}}
\newcommand{\pxtgyt}    [1][\time]{ \pxgy{\state_{#1}}{\obs_{#1}} }
\newcommand{\pxtgYt}    [1][\time]{ \pxgy{\state_{#1}}{\Obs_{#1}} }
\newcommand{\pXtgYt}    [1][\time]{ \pxgy{\State_{#1}}{\Obs_{#1}} }
\newcommand{\pytgxt}    [1][\time]{ \pxgy{\obs_{#1}}{\state_{#1}} }
\newcommand{\pxtgYtm}   [1][\time]{ \pxgy{\state_{#1}}{\Obs_{#1-1}} }
\newcommand{\pXtmgYtm}  [1][\time]{ \pxgy{\State_{#1-1}}{\Obs_{#1-1}} }
\newcommand{\pXtgYtm}   [1][\time]{ \pxgy{\State_{#1}}{\Obs_{#1-1}} }
\newcommand{\pxtgxtm}   [1][\time]{ \pxgy{\state_{#1}}{\state_{#1-1}} }
\newcommand{\pxtgXtm}   [1][\time]{ \pxgy{\state_{#1}}{\State_{#1-1}} }
\newcommand{\pxtgXtmYtm}   [1][\time]{ \pxgy{\state_{#1}}{\State_{#1-1},\Obs_{#1-1}} }

% Normal distribution
\newcommand{\gquad}       [3][1]    {\ensuremath{\frac{#1}{#2}(#3)^\T(#3)}}
\newcommand{\gquadnarrow} [3][{}]   {\ensuremath{\frac{#1(#3)^\T(#3)}{#2}}}
\newcommand{\gexp}        [3][1]    {\ensuremath{e^{-\gquad[#1]{2#2}{#3}}}}
\newcommand{\gquadm}      [3][ ]    {\ensuremath{#1(#3)^\T#2(#3)}}
\newcommand{\gexpm}       [3][\half]{\ensuremath{e^{-\gquadm[#1]{#2^{-1}}{#3}}}}

%\newcommand{\half}      {\frac{1}{2}}
\newcommand{\intd}      {\xspace\ensuremath{\,\mathstyle{d}}\xspace}
\newcommand{\N}[2]      {\ensuremath{\mathcal{N}(#1, #2)}}
\newcommand{\Nx}[3]     {\ensuremath{\mathcal{N}(#1\;|\;#2, #3)}}
\newcommand{\quadr}[2][]  {\half\;(#2)^\T\ifx#1\empty\else{#1}\fi(#2)}
\newcommand{\quadri}[2][]  {\quadr[#1^{-1}]{#2}}
%\newcommand{\Normal}[3] {(2\pi)^{-\frac{d}{2}} |#3|^{-\half} \exp\left[{ -\quadr{#2-#1}{#3} } \right]}
%\newcommand{\normal}[4] {\frac{e^{-\quadr{#2-#1}{#3} }}{(2\pi)^{\frac{#4}{2}}|#3|^{\half}}}
\newcommand{\normal}[3][1] {\gexp{#2}{#1-#3}}
\newcommand{\Normal}[4]    {\frac{1}{(2\pi)^{\frac{#4}{2}} \left|#2\right|^{\frac{1}{2}}}\ \gexpm{#2}{#1-#3}}

% Differential equations
\newcommand{\odiff}  [2] {\frac{\mathstyle{d}#1}{\mathstyle{d}#2}\xspace}
\newcommand{\pdiff}  [2] {\frac{\partial #1}{\partial #2}\xspace}

\renewcommand{\d}{\mathstyle{d}}

% 4-element matrix
\newcommand{\fourmat}[4]{%
  \ensuremath{
  \begin{pmatrix} 
  #1 & & #2 \\ 
  #3 & & #4       
  \end{pmatrix}
  }%
}
